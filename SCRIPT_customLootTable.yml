# Custom Loot Table
# Tyler J. Sawyer
# 4-7-14
# Defines custom loot items for particular mobs when they are slain.

"customLootTable":
  type: world
  events:
    on entity death:
      - if <context.damager.is_player> {
        - if <context.entity.entity_type> == "Enderman" {
          - drop "i@<proc:LootTable_Enderman>" location:<context.entity.location>
          - run "Drop_Credits" d:<context.damager>|<util.random.int[1].to[15]>
          - if <util.random.int[1].to[100]> >= 75 drop "i@<proc:LootTable_SpellMat>" location:<context.entity.location>
          }
        - if <context.entity.entity_type> == "Zombie" {
          - drop "i@<proc:LootTable_Zombie>" location:<context.entity.location>
          - run "Drop_Credits" d:<context.damager>|<util.random.int[1].to[4]>
          - if <util.random.int[1].to[100]> >= 75 drop "i@<proc:LootTable_SpellMat>" location:<context.entity.location>
          }
        - if <context.entity.entity_type> == "Skeleton" {
          - drop "i@<proc:LootTable_Skeleton>" location:<context.entity.location>
          - run "Drop_Credits" d:<context.damager>|<util.random.int[1].to[4]>
          - if <util.random.int[1].to[100]> >= 75 drop "i@<proc:LootTable_SpellMat>" location:<context.entity.location>
          }
        - if <context.entity.entity_type> == "Creeper" {
          - drop "i@<proc:LootTable_Creeper>" location:<context.entity.location>
          - run "Drop_Credits" d:<context.damager>|<util.random.int[1].to[4]>
          - if <util.random.int[1].to[100]> >= 75 drop "i@<proc:LootTable_SpellMat>" location:<context.entity.location>
          }
        - if <context.entity.entity_type> == "Spider" {
          - drop "i@<proc:LootTable_Spider>" location:<context.entity.location>
          - run "Drop_Credits" d:<context.damager>|<util.random.int[1].to[4]>
          - if <util.random.int[1].to[100]> >= 75 drop "i@<proc:LootTable_SpellMat>" location:<context.entity.location>
          }
        - if <context.entity.name> == "Bandit" {
          - run "Drop_Credits" d:<context.damager>|<util.random.int[2].to[12]>
          - if <util.random.int[1].to[100]> >= 75 drop "i@<proc:LootTable_SpellMat>" location:<context.entity.location>
          }
        - if <context.entity.name> == "Hate Fiend" {
          - drop "i@<proc:LootTable_HateKeep>" location:<context.damager.location>
          - run "Drop_Credits" d:<context.damager>|<util.random.int[25].to[50]>
          - if <util.random.int[1].to[100]> >= 75 drop "i@<proc:LootTable_SpellMat>" location:<context.entity.location>
          }
        - if <context.entity.name> == "Hate Sprite" {
          - drop "i@<proc:LootTable_HateKeep>" location:<context.damager.location>
          - run "Drop_Credits" d:<context.damager>|<util.random.int[15].to[35]>
          - if <util.random.int[1].to[100]> >= 75 drop "i@<proc:LootTable_SpellMat>" location:<context.entity.location>
          }
        - if <context.entity.name> == "Hate Golem" {
          - drop "i@<proc:LootTable_HateKeep>" location:<context.damager.location>
          - run "Drop_Credits" d:<context.damager>|<util.random.int[45].to[75]>
          - if <util.random.int[1].to[100]> >= 75 drop "i@<proc:LootTable_SpellMat>" location:<context.entity.location>
          }
        }

# To call : -run "Drop_Credits" d:ARG1|ARG2
"Drop_Credits":
   type: task
   definitions: killerEntity|creditAmt
   script:
     - define currentAmt <<%killerEntity%>.flag[CURRENCY_Credits]>
     - define newAmt <math.as_int:%currentAmt%+%creditAmt%>
     - flag <%killerEntity%> "CURRENCY_Credits:%newAmt%"
     - narrate targets:<%killerEntity%> "<&2>You loot %creditAmt% credits from the corpse."
        
"LootTable_SpellMat":
    type: procedure
    script:
      - random 24
      - determine "rune1"
      - determine "rune2"
      - determine "rune3"
      - determine "rune4"
      - determine "rune5"
      - determine "rune6"
      - determine "rune7"
      - determine "rune8"
      - determine "rune9"
      - determine "rune10"
      - determine "rune11"
      - determine "rune12"
      - determine "words1"
      - determine "words2"
      - determine "words3"
      - determine "words4"
      - determine "words5"
      - determine "words6"
      - determine "words7"
      - determine "words8"
      - determine "words9"
      - determine "words10"
      - determine "words11"
      - determine "words12"
        
# Procedure based on an example from :
# http://scripts.citizensnpcs.co/view/34aapf
# 
"LootTable_Enderman":
    type: procedure

    script:
    - define roll <util.random.int[1].to[5000]>
    - if %roll% >= 0 && %roll% < 4000 define quality "Common"
      else if %roll% >= 4000 && %roll% < 4750 define quality "Uncommon"
      else if %roll% >= 4750 && %roll% < 4970 define quality "Rare"
      else if %roll% >= 4970 define quality "Epic"
 
    - if %quality% == Common {
      - random 5
      - determine "Enderparts"
      - determine "Endersoul" 
      - determine "Enderdust"
      - determine "Enderthread"
      - determine "Endermold"
      }
 
    - if %quality% == Uncommon {
        - random 10
        - determine "Enderplate_Rings"
        - determine "Enderplate_Block"
        - determine "Sword_of_Ender"
        - determine "Ender_Scythe"
        - determine "Enderplate_Chestpiece"
        - determine "Enderplate_Leggings" 
        - determine "Enderplate_Boots"
        - determine "Enderplate_Helm" 
        - determine "Enderfish"
        - determine "Endercookie"
        }
 
    - if %quality% == Rare {
        - random 6
        - determine "Darkblade"
        - determine "Digmaster_5000"
        - determine "Runed_Enderplate_Helm"
        - determine "Runed_Enderplate_Chestpiece"
        - determine "Runed_Enderplate_Leggings"
        - determine "Runed_Enderplate_Boots"
        }
 
    - if %quality% == Epic {
        - random 2
        - determine "Rune_of_Healing"
        - determine "Journeyman_Boots"
        }

"LootTable_Zombie":
    type: procedure

    script:
    - define roll <util.random.int[1].to[5000]>
    - if %roll% >= 0 && %roll% < 4000 define quality "Common"
      else if %roll% >= 4000 && %roll% < 4750 define quality "Uncommon"
      else if %roll% >= 4750 && %roll% < 4970 define quality "Rare"
      else if %roll% >= 4970 define quality "Epic"
 
    - if %quality% == Common {
      - random 20
      - determine "Rock"
      - determine "PetRock" 
      - determine "Pile_of_Dirt"
      - determine "Pile_of_Mud"
      - determine "Torn_Sheet_of_Paper"
      - determine "Snapped_Twig"
      - determine "Driftwood"
      - determine "Chunk_of_Flint"
      - determine "Marshmellow"
      - determine "Rusty_Longsword"
      - determine "Rusty_Shortsword"
      - determine "Rusty_Two_Handed_Sword"
      - determine "Rusty_Dagger"
      - determine "Rusty_Rapier"
      - determine "Rusty_Scimitar"
      - determine "Rusty_Warhammer"
      - determine "Rusty_Axe"
      - determine "Rusty_Battleaxe"
      - determine "Rusty_Great_Axe"
      - determine "Rusty_Scythe"
      }
 
    - if %quality% == Uncommon {
        - random 20
        - determine "Tarnished_Longsword"
        - determine "Tarnished_Shortsword"
        - determine "Tarnished_Two_Handed_Sword"
        - determine "Tarnished_Dagger"
        - determine "Tarnished_Rapier"
        - determine "Tarnished_Scimitar"
        - determine "Tarnished_Warhammer"
        - determine "Tarnished_Axe"
        - determine "Tarnished_Battleaxe"
        - determine "Tarnished_Great_Axe"
        - determine "Tarnished_Scythe"
        - determine "Leather_Scraps"
        - determine "Patchwork_Leather_Hat"
        - determine "Patchwork_Leather_Tunic"
        - determine "Patchwork_Leather_Pants"
        - determine "Patchwork_Leather_Boots"
        - determine "Tattered_Leather_Hat"
        - determine "Tattered_Leather_Tunic"
        - determine "Tattered_Leather_Pants"
        - determine "Tattered_Leather_Boots"
        }
 
    - if %quality% == Rare {
        - random 6
        - determine "Ringmail_Coif"
        - determine "Ringmail_Tunic"
        - determine "Ringmail_Leggings"
        - determine "Ringmail_Boots"
        - determine "Ashwood_Recurve_Bow"
        - determine "Redwood_Recurve_Bow"
        }
 
    - if %quality% == Epic {
        - random 3
        - determine "Nightblade"
        - determine "Willsapper"
        - determine "Eyepatch_of_Plunder"
        }

"LootTable_Skeleton":
    type: procedure

    script:
    - define roll <util.random.int[1].to[5000]>
    - if %roll% >= 0 && %roll% < 4000 define quality "Common"
      else if %roll% >= 4000 && %roll% < 4750 define quality "Uncommon"
      else if %roll% >= 4750 && %roll% < 4970 define quality "Rare"
      else if %roll% >= 4970 define quality "Epic"
 
    - if %quality% == Common {
      - random 20
      - determine "Rock"
      - determine "PetRock" 
      - determine "Pile_of_Dirt"
      - determine "Pile_of_Mud"
      - determine "Torn_Sheet_of_Paper"
      - determine "Snapped_Twig"
      - determine "Driftwood"
      - determine "Chunk_of_Flint"
      - determine "Marshmellow"
      - determine "Rusty_Longsword"
      - determine "Rusty_Shortsword"
      - determine "Rusty_Two_Handed_Sword"
      - determine "Rusty_Dagger"
      - determine "Rusty_Rapier"
      - determine "Rusty_Scimitar"
      - determine "Rusty_Warhammer"
      - determine "Rusty_Axe"
      - determine "Rusty_Battleaxe"
      - determine "Rusty_Great_Axe"
      - determine "Rusty_Scythe"
      }
 
    - if %quality% == Uncommon {
        - random 20
        - determine "Tarnished_Longsword"
        - determine "Tarnished_Shortsword"
        - determine "Tarnished_Two_Handed_Sword"
        - determine "Tarnished_Dagger"
        - determine "Tarnished_Rapier"
        - determine "Tarnished_Scimitar"
        - determine "Tarnished_Warhammer"
        - determine "Tarnished_Axe"
        - determine "Tarnished_Battleaxe"
        - determine "Tarnished_Great_Axe"
        - determine "Tarnished_Scythe"
        - determine "Leather_Scraps"
        - determine "Patchwork_Leather_Hat"
        - determine "Patchwork_Leather_Tunic"
        - determine "Patchwork_Leather_Pants"
        - determine "Patchwork_Leather_Boots"
        - determine "Tattered_Leather_Hat"
        - determine "Tattered_Leather_Tunic"
        - determine "Tattered_Leather_Pants"
        - determine "Tattered_Leather_Boots"
        }
 
    - if %quality% == Rare {
        - random 6
        - determine "Ringmail_Coif"
        - determine "Ringmail_Tunic"
        - determine "Ringmail_Leggings"
        - determine "Ringmail_Boots"
        - determine "Ashwood_Recurve_Bow"
        - determine "Redwood_Recurve_Bow"
        }
 
    - if %quality% == Epic {
        - random 3
        - determine "Nightblade"
        - determine "Willsapper"
        - determine "Eyepatch_of_Plunder"
        }

"LootTable_Creeper":
    type: procedure

    script:
    - define roll <util.random.int[1].to[5000]>
    - if %roll% >= 0 && %roll% < 4000 define quality "Common"
      else if %roll% >= 4000 && %roll% < 4750 define quality "Uncommon"
      else if %roll% >= 4750 && %roll% < 4970 define quality "Rare"
      else if %roll% >= 4970 define quality "Epic"
 
    - if %quality% == Common {
      - random 20
      - determine "Rock"
      - determine "PetRock" 
      - determine "Pile_of_Dirt"
      - determine "Pile_of_Mud"
      - determine "Torn_Sheet_of_Paper"
      - determine "Snapped_Twig"
      - determine "Driftwood"
      - determine "Chunk_of_Flint"
      - determine "Marshmellow"
      - determine "Rusty_Longsword"
      - determine "Rusty_Shortsword"
      - determine "Rusty_Two_Handed_Sword"
      - determine "Rusty_Dagger"
      - determine "Rusty_Rapier"
      - determine "Rusty_Scimitar"
      - determine "Rusty_Warhammer"
      - determine "Rusty_Axe"
      - determine "Rusty_Battleaxe"
      - determine "Rusty_Great_Axe"
      - determine "Rusty_Scythe"
      }
 
    - if %quality% == Uncommon {
        - random 20
        - determine "Tarnished_Longsword"
        - determine "Tarnished_Shortsword"
        - determine "Tarnished_Two_Handed_Sword"
        - determine "Tarnished_Dagger"
        - determine "Tarnished_Rapier"
        - determine "Tarnished_Scimitar"
        - determine "Tarnished_Warhammer"
        - determine "Tarnished_Axe"
        - determine "Tarnished_Battleaxe"
        - determine "Tarnished_Great_Axe"
        - determine "Tarnished_Scythe"
        - determine "Leather_Scraps"
        - determine "Patchwork_Leather_Hat"
        - determine "Patchwork_Leather_Tunic"
        - determine "Patchwork_Leather_Pants"
        - determine "Patchwork_Leather_Boots"
        - determine "Tattered_Leather_Hat"
        - determine "Tattered_Leather_Tunic"
        - determine "Tattered_Leather_Pants"
        - determine "Tattered_Leather_Boots"
        }
 
    - if %quality% == Rare {
        - random 6
        - determine "Ringmail_Coif"
        - determine "Ringmail_Tunic"
        - determine "Ringmail_Leggings"
        - determine "Ringmail_Boots"
        - determine "Ashwood_Recurve_Bow"
        - determine "Redwood_Recurve_Bow"
        }
 
    - if %quality% == Epic {
        - random 3
        - determine "Nightblade"
        - determine "Willsapper"
        - determine "Eyepatch_of_Plunder"
        }

"LootTable_Spider":
    type: procedure

    script:
    - define roll <util.random.int[1].to[5000]>
    - if %roll% >= 0 && %roll% < 4000 define quality "Common"
      else if %roll% >= 4000 && %roll% < 4750 define quality "Uncommon"
      else if %roll% >= 4750 && %roll% < 4970 define quality "Rare"
      else if %roll% >= 4970 define quality "Epic"
 
    - if %quality% == Common {
      - random 11
      - determine "Rock"
      - determine "PetRock" 
      - determine "Pile_of_Dirt"
      - determine "Pile_of_Mud"
      - determine "Torn_Sheet_of_Paper"
      - determine "Snapped_Twig"
      - determine "Driftwood"
      - determine "Chunk_of_Flint"
      - determine "Marshmellow"
      - determine "Dusty_Cobwebs"
      - determine "Piece_of_String"
      }
 
    - if %quality% == Uncommon {
        - random 9
        - determine "Leather_Scraps"
        - determine "Patchwork_Leather_Hat"
        - determine "Patchwork_Leather_Tunic"
        - determine "Patchwork_Leather_Pants"
        - determine "Patchwork_Leather_Boots"
        - determine "Tattered_Leather_Hat"
        - determine "Tattered_Leather_Tunic"
        - determine "Tattered_Leather_Pants"
        - determine "Tattered_Leather_Boots"
        }
 
    - if %quality% == Rare {
        - random 6
        - determine "Ringmail_Coif"
        - determine "Ringmail_Tunic"
        - determine "Ringmail_Leggings"
        - determine "Ringmail_Boots"
        - determine "Ashwood_Recurve_Bow"
        - determine "Redwood_Recurve_Bow"
        }
 
    - if %quality% == Epic {
        - random 3
        - determine "Nightblade"
        - determine "Willsapper"
        - determine "Eyepatch_of_Plunder"
        }
        
"LootTable_HateKeep":
    type: procedure

    script:
    - define roll <util.random.int[1].to[10000]>
    - if %roll% >= 0 && %roll% < 9000 define quality "Common"
      else if %roll% >= 9000 && %roll% < 9800 define quality "Uncommon"
      else if %roll% >= 9800 && %roll% < 9950 define quality "Rare"
      else if %roll% >= 9950 define quality "Epic"
 
    - if %quality% == Common {
      - random 5
      - determine "Enderparts"
      - determine "Endersoul" 
      - determine "Enderdust"
      - determine "Enderthread"
      - determine "Endermold"
      }
 
    - if %quality% == Uncommon {
        - random 10
        - determine "Enderplate_Chestpiece"
        - determine "Enderplate_Leggings" 
        - determine "Enderplate_Boots"
        - determine "Enderplate_Helm" 
        - determine "Enderfish"
        - determine "Endercookie"
        - determine "Hatesteel_Leggings"
        - determine "Hatesteel_Boots"
        - determine "Hatesteel_Chestpiece"
        - determine "Hatesteel_Helm"
        }
 
    - if %quality% == Rare {
        - random 6
        - determine "Doom"
        - determine "Blue_Harbinger"
        - determine "Runed_Enderplate_Helm"
        - determine "Runed_Enderplate_Chestpiece"
        - determine "Runed_Enderplate_Leggings"
        - determine "Runed_Enderplate_Boots"
        }
 
    - if %quality% == Epic {
        - random 2
        - determine "Hurricane"
        - determine "Bucket_of_Saturation"
        }