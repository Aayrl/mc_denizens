# Tyler J. Sawyer
# This removes all levels from players when they die.
# This also damages all their items by 25%.

"onPlayerDeathEvent":
  type: world
  events:
    on player death:
    - narrate "<red>You have died!"
    - narrate "<red>You have lost all of your experience!"
    - narrate "<red>All gear in your inventory have taken a 25% durability hit."
    - execute as_server "xp -50000L <player.name>"
    on testinv command:
    - narrate "<&5>Running testinv command.."
    - foreach <p@<player.name>.inventory<inventory.list_contents>.as_list> {
      - narrate "YOLO TEST SWAG VALUE<&co> %value%" 
      - if <%value%.repairable> {
        - narrate "<yellow>THIS ITEM HAS DURABILITY."
        - narrate "<yellow>Durability<&co> <%value%.durability>/<%value%.max_durability> "
        - narrate "<red>Attempting to modify durability amount<&co> -<math.as_int:<math.as_int:<%value%.max_durability>*0.25>+<%value%.durability>>"
        - take %value%
        - adjust %value% "durability:<math.as_int:<math.as_int:<%value%.max_durability>*0.25>+<%value%.durability>>" save:breakitem
        - give <entry[breakitem].result> 
        - narrate "<yellow>Durability<&co> <%value%.durability>/<%value%.max_durability> "
        }
      if <%value%.durability> <= <%value%.max_durability> {
        - take %value% }
      }